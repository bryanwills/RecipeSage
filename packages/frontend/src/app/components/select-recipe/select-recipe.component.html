<div>
  @if (selectedRecipe) {
    <ion-item
      class="selectedRecipe"
      (click)="selectedRecipe = undefined"
      button
    >
      @if (selectedRecipe.recipeImages.length) {
        <ion-avatar slot="start">
          <img src="{{ selectedRecipe.recipeImages[0].image.location }}" />
        </ion-avatar>
      }
      @if (!selectedRecipe.recipeImages.length) {
        <ion-avatar slot="start">
          <img src="assets/imgs/logo_green_padded.png" />
        </ion-avatar>
      }
      <ion-label>
        <h2>{{ selectedRecipe.title }}</h2>
        <p>
          {{ "components.selectRecipe.change" | translate }}
        </p>
      </ion-label>
    </ion-item>
  }

  @if (!selectedRecipe) {
    <div>
      <ion-searchbar
        [(ngModel)]="searchText"
        (ionInput)="onSearchInputChange()"
        placeholder="{{ 'components.selectRecipe.search' | translate }}"
        autocomplete="off"
      ></ion-searchbar>
      <div class="ion-padding-start ion-padding-end">
        @if (searchText.length) {
          <div class="results-list-container">
            <div class="results-list">
              @for (recipe of recipes; track recipeTrackBy($index, recipe)) {
                <ion-item (click)="selectRecipe(recipe)" button>
                  @if (recipe.recipeImages.length) {
                    <ion-avatar slot="start">
                      <img src="{{ recipe.recipeImages[0].image.location }}" />
                    </ion-avatar>
                  }
                  @if (!recipe.recipeImages.length) {
                    <ion-avatar slot="start">
                      <img src="assets/imgs/logo_green_padded.png" />
                    </ion-avatar>
                  }
                  <ion-label>
                    <h2>{{ recipe.title }}</h2>
                    <p>
                      {{ "components.selectRecipe.select" | translate }}
                    </p>
                  </ion-label>
                  @if (myProfile && myProfile.id !== recipe.userId) {
                    <ion-badge>
                      @if (friendsById && friendsById[recipe.userId]) {
                        &commat;{{ friendsById[recipe.userId].handle }}
                      }
                      @if (!friendsById || !friendsById[recipe.userId]) {
                        {{
                          "pages.home.recipe.fromSharedCollection" | translate
                        }}
                      }
                    </ion-badge>
                  }
                </ion-item>
              }
              <!-- Searching for user for which a thread does not exist -->
              @if (searching) {
                <ion-item>
                  <ion-spinner slot="start"></ion-spinner>
                  <ion-label>
                    <h2>
                      {{
                        "components.selectRecipe.searching"
                          | translate: { searchText: searchText }
                      }}
                    </h2>
                  </ion-label>
                </ion-item>
              }
              <!-- Searching for user for which a thread does not exist -->
              @if (
                recipes.length === 0 && searchText.length > 0 && !searching
              ) {
                <ion-item>
                  <ion-icon name="folder-open" slot="start"></ion-icon>
                  <ion-label>
                    <h2>
                      {{
                        "components.selectRecipe.null"
                          | translate: { searchText: searchText }
                      }}
                    </h2>
                  </ion-label>
                </ion-item>
              }
            </div>
          </div>
        }
      </div>
    </div>
  }
</div>
